name: Create Renovate config
description: Create renovate.json with default configuration for repos that don't have it (excluding .github repo)

conditions:
  - type: and
    conditions:
      - type: file_not_exists
        path: renovate.json
      - type: file_not_exists
        path: .github/renovate.json
      - type: file_not_exists
        path: .github/renovate.json5
      - type: repo_name_not_matches
        pattern: ^\.github$

actions:
  - type: create_file
    path: renovate.json
    message: "Add Renovate configuration"
    content: |
      {
        "$schema": "https://docs.renovatebot.com/renovate-schema.json",
        "extends": [
          "config:base"
        ],
        "packageRules": [
          {
            "matchUpdateTypes": ["minor", "patch"],
            "automerge": true
          }
        ],
        "schedule": ["before 5am on Monday"],
        "timezone": "UTC"
      }
